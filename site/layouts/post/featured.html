{{ if .Params.featured }}
  <a href="{{ .RelPermalink }}" class="image featured">
      {{ $src := .Page.Resources.GetMatch .Params.featured }}

      {{/* set image sizes, these are hardcoded for now, x dictates that images are resized to this width */}}

      {{ $tinyw := default "500x262 center" }}
      {{ $smallw := default "800x419 center" }}
      {{ $mediumw := default "1200x628 center" }}
      {{ $largew := default "1500x785 center" }}

      {{/* resize the src image to the given sizes */}}

      {{ .Scratch.Set "tiny" ($src.Fill $tinyw) }}
      {{ .Scratch.Set "small" ($src.Fill $smallw) }}
      {{ .Scratch.Set "medium" ($src.Fill $mediumw) }}
      {{ .Scratch.Set "large" ($src.Fill $largew) }}

      {{/* add the processed images to the scratch */}}

      {{ $tiny := .Scratch.Get "tiny" }}
      {{ $small := .Scratch.Get "small" }}
      {{ $medium := .Scratch.Get "medium" }}
      {{ $large := .Scratch.Get "large" }}

      {{/* only use images smaller than or equal to the src (original) image size, as Hugo will upscale small images */}}

      <img
        sizes="(min-width: 320px) 452px, (min-width: 800px) 704px, (min-width: 1200px) 670px, (min-width: 1500px) 910px, 100vw"
        srcset='
        {{ if ge $src.Width "500" }}
          {{ with $tiny.RelPermalink }}{{.}} 500w{{ end }}
        {{ end }}
        {{ if ge $src.Width "800" }}
          {{ with $small.RelPermalink }}, {{.}} 800w{{ end }}
        {{ end }}
        {{ if ge $src.Width "1200" }}
          {{ with $medium.RelPermalink }}, {{.}} 1200w{{ end }}
        {{ end }}
        {{ if ge $src.Width "1500" }}
          {{ with $large.RelPermalink }}, {{.}} 1500w {{ end }}
        {{ end }}'
        src="{{ $src.RelPermalink }}"
        alt='{{ .Params.featuredalt }}'>
  </a>
{{ end }}
